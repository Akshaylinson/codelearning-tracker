<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learning Path Tracker | Professional Development</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#10b981',
                        secondary: '#111827',
                        accent: '#059669',
                        dark: '#000000',
                        'dark-card': '#1f2937',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.5s ease-out',
                        'pulse-slow': 'pulse 3s infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(10px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .glass {
                @apply bg-dark-card/80 backdrop-blur-md border border-green-500/20;
            }
            .glass-dark {
                @apply bg-black/70 backdrop-blur-md border border-green-500/10;
            }
            .gradient-bg {
                background: linear-gradient(135deg, #000000 0%, #111827 50%, #064e3b 100%);
            }
            .text-gradient {
                @apply bg-gradient-to-r from-green-400 to-emerald-500 bg-clip-text text-transparent;
            }
            .glow {
                box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
            }
        }
    </style>
</head>
<body class="min-h-screen gradient-bg text-white font-sans">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-8 md:mb-12 animate-fade-in">
            <h1 class="text-3xl md:text-5xl font-bold mb-2 md:mb-4 text-gradient">Learning Path Tracker</h1>
            <p class="text-lg md:text-xl text-green-200 max-w-2xl mx-auto px-2">Track your daily learning activities and optimize your IT career journey</p>
        </header>

        <!-- Main Content -->
        <main class="grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8">
            <!-- Task Management Section -->
            <section class="lg:col-span-2 space-y-6 md:space-y-8">
                <!-- Week Navigation -->
                <div class="glass-dark rounded-2xl p-4 md:p-6 shadow-xl glow">
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-4 md:mb-6 space-y-4 sm:space-y-0">
                        <h2 class="text-xl md:text-2xl font-semibold text-green-300">Weekly Tasks</h2>
                        <div class="flex space-x-2">
                            <button id="prev-week" class="glass px-3 py-2 md:px-4 md:py-2 rounded-lg hover:bg-green-900/30 transition-all text-green-300">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <span id="week-display" class="glass px-4 py-2 rounded-lg font-medium text-green-300 text-sm md:text-base">Week 1</span>
                            <button id="next-week" class="glass px-3 py-2 md:px-4 md:py-2 rounded-lg hover:bg-green-900/30 transition-all text-green-300">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Days Grid -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4">
                        <!-- Day Cards will be generated here -->
                    </div>
                </div>

                <!-- Add Task Form -->
                <div class="glass-dark rounded-2xl p-4 md:p-6 shadow-xl animate-slide-up glow">
                    <h3 class="text-lg md:text-xl font-semibold mb-3 md:mb-4 text-green-300">Add New Task</h3>
                    <form id="task-form" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-1 text-green-200">Day</label>
                                <select id="task-day" class="w-full bg-dark-card border border-green-500/30 rounded-lg px-3 py-2 md:px-4 md:py-2 focus:outline-none focus:ring-2 focus:ring-green-500 text-white text-sm md:text-base">
                                    <option value="monday">Monday</option>
                                    <option value="tuesday">Tuesday</option>
                                    <option value="wednesday">Wednesday</option>
                                    <option value="thursday">Thursday</option>
                                    <option value="friday">Friday</option>
                                    <option value="saturday">Saturday</option>
                                    <option value="sunday">Sunday</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1 text-green-200">Domain</label>
                                <select id="task-domain" class="w-full bg-dark-card border border-green-500/30 rounded-lg px-3 py-2 md:px-4 md:py-2 focus:outline-none focus:ring-2 focus:ring-green-500 text-white text-sm md:text-base">
                                    <!-- Domain options will be populated dynamically -->
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-green-200">Task Description</label>
                            <input id="task-description" type="text" placeholder="e.g., Complete ML project, Study algorithms..." class="w-full bg-dark-card border border-green-500/30 rounded-lg px-3 py-2 md:px-4 md:py-2 focus:outline-none focus:ring-2 focus:ring-green-500 text-white text-sm md:text-base">
                        </div>
                        <button type="submit" class="w-full bg-gradient-to-r from-green-600 to-emerald-700 hover:from-green-700 hover:to-emerald-800 text-white font-medium py-2 px-4 rounded-lg transition-all duration-300 transform hover:scale-[1.02] shadow-lg text-sm md:text-base">Add Task</button>
                    </form>
                </div>

                <!-- Domain Management -->
                <div class="glass-dark rounded-2xl p-4 md:p-6 shadow-xl animate-slide-up glow">
                    <div class="flex justify-between items-center mb-3 md:mb-4">
                        <h3 class="text-lg md:text-xl font-semibold text-green-300">Manage Domains</h3>
                        <button id="show-domain-modal" class="bg-green-600 hover:bg-green-700 text-white font-medium py-1 px-3 rounded-lg transition-all duration-300 text-sm md:text-base">
                            <i class="fas fa-plus mr-1"></i> Add Domain
                        </button>
                    </div>
                    <div class="space-y-4">
                        <div class="flex flex-wrap gap-2" id="domain-tags">
                            <!-- Domain tags will appear here -->
                        </div>
                        <p class="text-xs text-green-200">Click on a domain to assign it to specific days</p>
                    </div>
                </div>
            </section>

            <!-- Analytics Section -->
            <section class="space-y-6 md:space-y-8">
                <!-- Stats Overview -->
                <div class="glass-dark rounded-2xl p-4 md:p-6 shadow-xl animate-slide-up glow">
                    <h2 class="text-xl md:text-2xl font-semibold mb-4 md:mb-6 text-green-300">Progress Overview</h2>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center">
                            <span class="text-green-200 text-sm md:text-base">Completion Rate</span>
                            <span id="completion-rate" class="text-lg md:text-xl font-bold text-green-400">0%</span>
                        </div>
                        <div class="w-full bg-gray-800 rounded-full h-2.5">
                            <div id="completion-bar" class="bg-gradient-to-r from-green-500 to-emerald-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                        <div class="grid grid-cols-2 gap-3 md:gap-4 mt-4 md:mt-6">
                            <div class="text-center p-3 md:p-4 glass rounded-lg">
                                <div class="text-xl md:text-2xl font-bold text-green-400" id="completed-tasks">0</div>
                                <div class="text-xs md:text-sm text-green-300">Completed</div>
                            </div>
                            <div class="text-center p-3 md:p-4 glass rounded-lg">
                                <div class="text-xl md:text-2xl font-bold text-emerald-400" id="total-tasks">0</div>
                                <div class="text-xs md:text-sm text-emerald-300">Total Tasks</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Domain Distribution -->
                <div class="glass-dark rounded-2xl p-4 md:p-6 shadow-xl animate-slide-up glow">
                    <h2 class="text-xl md:text-2xl font-semibold mb-3 md:mb-4 text-green-300">Domain Focus</h2>
                    <div class="h-48 md:h-64">
                        <canvas id="domain-chart"></canvas>
                    </div>
                </div>

                <!-- Monthly Progress -->
                <div class="glass-dark rounded-2xl p-4 md:p-6 shadow-xl animate-slide-up glow">
                    <h2 class="text-xl md:text-2xl font-semibold mb-3 md:mb-4 text-green-300">Monthly Progress</h2>
                    <div class="h-48 md:h-64">
                        <canvas id="monthly-chart"></canvas>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Domain Assignment Modal -->
    <div id="domain-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 hidden">
        <div class="glass-dark rounded-2xl p-6 w-full max-w-md mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-green-300" id="modal-title">Assign Domain to Days</h3>
                <button id="close-modal" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2 text-green-200">Select Days for <span id="selected-domain-name" class="font-semibold"></span></label>
                    <div class="grid grid-cols-2 gap-2">
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="day-checkbox" value="monday">
                            <span class="text-white">Monday</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="day-checkbox" value="tuesday">
                            <span class="text-white">Tuesday</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="day-checkbox" value="wednesday">
                            <span class="text-white">Wednesday</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="day-checkbox" value="thursday">
                            <span class="text-white">Thursday</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="day-checkbox" value="friday">
                            <span class="text-white">Friday</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="day-checkbox" value="saturday">
                            <span class="text-white">Saturday</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="day-checkbox" value="sunday">
                            <span class="text-white">Sunday</span>
                        </label>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button id="cancel-modal" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors">Cancel</button>
                    <button id="save-domain-days" class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition-colors">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Domain Modal -->
    <div id="add-domain-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 hidden">
        <div class="glass-dark rounded-2xl p-6 w-full max-w-md mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-green-300">Add New Domain</h3>
                <button id="close-add-modal" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2 text-green-200">Domain Name</label>
                    <input type="text" id="new-domain-name" class="w-full bg-dark-card border border-green-500/30 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 text-white" placeholder="e.g., AI/ML, Web Development">
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button id="cancel-add-modal" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors">Cancel</button>
                    <button id="save-new-domain" class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition-colors">Add Domain</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data Management
        class LearningTracker {
            constructor() {
                this.currentWeek = 1;
                this.weeks = this.loadData() || {};
                this.domains = this.loadDomains() || [
                    { name: 'AI/ML', days: ['monday', 'wednesday', 'friday'] },
                    { name: 'Web Development', days: ['tuesday', 'thursday'] },
                    { name: 'Data Science', days: ['monday', 'wednesday'] },
                    { name: 'Cloud Computing', days: ['tuesday', 'friday'] },
                    { name: 'Cybersecurity', days: ['thursday', 'saturday'] },
                    { name: 'Programming', days: ['monday', 'wednesday', 'friday'] }
                ];
                this.monthsData = this.loadMonthsData() || {};
                this.currentEditingDomain = null;
                this.init();
            }

            init() {
                this.renderWeek();
                this.setupEventListeners();
                this.renderDomainTags();
                this.updateDomainSelect();
                this.updateAnalytics();
            }

            loadData() {
                const data = localStorage.getItem('learningTracker');
                return data ? JSON.parse(data) : {};
            }

            saveData() {
                localStorage.setItem('learningTracker', JSON.stringify(this.weeks));
            }

            loadDomains() {
                const data = localStorage.getItem('learningTrackerDomains');
                return data ? JSON.parse(data) : null;
            }

            saveDomains() {
                localStorage.setItem('learningTrackerDomains', JSON.stringify(this.domains));
            }

            loadMonthsData() {
                const data = localStorage.getItem('learningTrackerMonths');
                return data ? JSON.parse(data) : {};
            }

            saveMonthsData() {
                localStorage.setItem('learningTrackerMonths', JSON.stringify(this.monthsData));
            }

            getCurrentWeekData() {
                if (!this.weeks[this.currentWeek]) {
                    this.weeks[this.currentWeek] = this.initializeWeekWithDomains();
                }
                return this.weeks[this.currentWeek];
            }

            initializeWeekWithDomains() {
                const weekData = {
                    monday: [],
                    tuesday: [],
                    wednesday: [],
                    thursday: [],
                    friday: [],
                    saturday: [],
                    sunday: []
                };

                // Add domain tasks for each day based on domain assignments
                this.domains.forEach(domain => {
                    domain.days.forEach(day => {
                        weekData[day].push({
                            id: Date.now() + Math.random(),
                            domain: domain.name,
                            description: `Work on ${domain.name}`,
                            completed: false,
                            createdAt: new Date().toISOString(),
                            isDomainTask: true
                        });
                    });
                });

                return weekData;
            }

            addTask(day, domain, description) {
                const weekData = this.getCurrentWeekData();
                weekData[day].push({
                    id: Date.now(),
                    domain,
                    description,
                    completed: false,
                    createdAt: new Date().toISOString(),
                    isDomainTask: false
                });
                this.saveData();
                this.updateMonthsData(domain);
                this.renderWeek();
                this.updateAnalytics();
            }

            addDomain(domainName) {
                if (domainName && !this.domains.some(d => d.name === domainName)) {
                    this.domains.push({
                        name: domainName,
                        days: []
                    });
                    this.saveDomains();
                    this.renderDomainTags();
                    this.updateDomainSelect();
                    this.renderWeek(); // Refresh week to show new domain tasks
                }
            }

            updateDomainDays(domainName, days) {
                const domain = this.domains.find(d => d.name === domainName);
                if (domain) {
                    domain.days = days;
                    this.saveDomains();
                    
                    // Update all weeks with the new domain assignments
                    Object.keys(this.weeks).forEach(week => {
                        // Remove existing domain tasks for this domain
                        Object.keys(this.weeks[week]).forEach(day => {
                            this.weeks[week][day] = this.weeks[week][day].filter(
                                task => !(task.isDomainTask && task.domain === domainName)
                            );
                        });
                        
                        // Add domain tasks to assigned days
                        days.forEach(day => {
                            this.weeks[week][day].push({
                                id: Date.now() + Math.random(),
                                domain: domainName,
                                description: `Work on ${domainName}`,
                                completed: false,
                                createdAt: new Date().toISOString(),
                                isDomainTask: true
                            });
                        });
                    });
                    
                    this.saveData();
                    this.renderWeek();
                }
            }

            removeDomain(domainName) {
                const index = this.domains.findIndex(d => d.name === domainName);
                if (index > -1) {
                    this.domains.splice(index, 1);
                    this.saveDomains();
                    this.renderDomainTags();
                    this.updateDomainSelect();
                    
                    // Remove tasks with this domain from all weeks
                    Object.keys(this.weeks).forEach(week => {
                        Object.keys(this.weeks[week]).forEach(day => {
                            this.weeks[week][day] = this.weeks[week][day].filter(
                                task => task.domain !== domainName
                            );
                        });
                    });
                    this.saveData();
                    this.renderWeek();
                    this.updateAnalytics();
                }
            }

            updateMonthsData(domain) {
                const currentDate = new Date();
                const monthYear = `${currentDate.getFullYear()}-${currentDate.getMonth() + 1}`;
                
                if (!this.monthsData[monthYear]) {
                    this.monthsData[monthYear] = {};
                }
                
                if (!this.monthsData[monthYear][domain]) {
                    this.monthsData[monthYear][domain] = 0;
                }
                
                // Increment task count for this domain in current month
                this.monthsData[monthYear][domain] += 1;
                
                this.saveMonthsData();
            }

            toggleTask(day, taskId) {
                const weekData = this.getCurrentWeekData();
                const task = weekData[day].find(t => t.id === taskId);
                if (task) {
                    task.completed = !task.completed;
                    this.saveData();
                    this.renderWeek();
                    this.updateAnalytics();
                }
            }

            deleteTask(day, taskId) {
                const weekData = this.getCurrentWeekData();
                const taskIndex = weekData[day].findIndex(t => t.id === taskId);
                if (taskIndex > -1 && !weekData[day][taskIndex].isDomainTask) {
                    weekData[day].splice(taskIndex, 1);
                    this.saveData();
                    this.renderWeek();
                    this.updateAnalytics();
                }
            }

            renderWeek() {
                const weekData = this.getCurrentWeekData();
                const daysContainer = document.querySelector('.grid.grid-cols-1.sm\\:grid-cols-2.lg\\:grid-cols-3.gap-3.md\\:gap-4');
                const weekDisplay = document.getElementById('week-display');
                
                weekDisplay.textContent = `Week ${this.currentWeek}`;
                daysContainer.innerHTML = '';

                const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
                
                days.forEach(day => {
                    const dayData = weekData[day];
                    const dayCard = this.createDayCard(day, dayData);
                    daysContainer.appendChild(dayCard);
                });
            }

            createDayCard(day, tasks) {
                const dayCard = document.createElement('div');
                dayCard.className = 'glass rounded-xl p-3 md:p-4 transition-all duration-300 hover:bg-green-900/10';
                
                const dayName = day.charAt(0).toUpperCase() + day.slice(1);
                const completedCount = tasks.filter(t => t.completed).length;
                const totalCount = tasks.length;
                
                dayCard.innerHTML = `
                    <div class="flex justify-between items-center mb-2 md:mb-3">
                        <h3 class="font-semibold text-green-300 text-sm md:text-lg">${dayName}</h3>
                        <span class="text-xs bg-green-500/20 text-green-300 px-2 py-1 rounded-full">${completedCount}/${totalCount}</span>
                    </div>
                    <div class="space-y-2 max-h-40 md:max-h-60 overflow-y-auto">
                        ${tasks.length > 0 ? 
                            tasks.map(task => `
                                <div class="p-2 md:p-3 rounded-lg bg-dark-card border border-green-500/20 transition-all duration-300 ${task.completed ? 'opacity-70' : ''}">
                                    <div class="flex justify-between items-start">
                                        <div class="flex items-center space-x-2">
                                            <input type="checkbox" ${task.completed ? 'checked' : ''} 
                                                class="h-3 w-3 md:h-4 md:w-4 rounded border-gray-300 text-green-600 focus:ring-green-500 bg-dark-card" 
                                                data-day="${day}" data-id="${task.id}">
                                            <span class="${task.completed ? 'line-through text-gray-400' : 'text-white'} text-xs md:text-sm">${task.description}</span>
                                        </div>
                                        ${!task.isDomainTask ? `
                                            <button class="text-red-400 hover:text-red-300 transition-colors delete-task" data-day="${day}" data-id="${task.id}">
                                                <i class="fas fa-times text-xs md:text-sm"></i>
                                            </button>
                                        ` : ''}
                                    </div>
                                    <div class="mt-1 flex justify-between items-center">
                                        <span class="text-xs px-2 py-1 rounded-full ${this.getDomainColor(task.domain)}">${task.domain}</span>
                                        <span class="text-xs text-gray-400">${task.isDomainTask ? 'Domain Task' : new Date(task.createdAt).toLocaleDateString()}</span>
                                    </div>
                                </div>
                            `).join('') : 
                            '<p class="text-gray-400 text-center py-3 md:py-4 text-xs md:text-sm">No tasks for this day</p>'
                        }
                    </div>
                `;
                
                return dayCard;
            }

            renderDomainTags() {
                const container = document.getElementById('domain-tags');
                container.innerHTML = '';
                
                this.domains.forEach(domain => {
                    const tag = document.createElement('div');
                    tag.className = `inline-flex items-center px-3 py-1 rounded-full text-xs md:text-sm cursor-pointer ${this.getDomainColor(domain.name)} hover:opacity-80 transition-opacity`;
                    tag.innerHTML = `
                        ${domain.name}
                        <button class="ml-2 text-red-400 hover:text-red-300 delete-domain" data-domain="${domain.name}">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    container.appendChild(tag);
                });
            }

            updateDomainSelect() {
                const select = document.getElementById('task-domain');
                select.innerHTML = '';
                
                this.domains.forEach(domain => {
                    const option = document.createElement('option');
                    option.value = domain.name;
                    option.textContent = domain.name;
                    select.appendChild(option);
                });
            }

            openDomainModal(domainName) {
                this.currentEditingDomain = domainName;
                document.getElementById('selected-domain-name').textContent = domainName;
                
                // Clear all checkboxes
                document.querySelectorAll('.day-checkbox').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                // Check the days assigned to this domain
                const domain = this.domains.find(d => d.name === domainName);
                if (domain) {
                    domain.days.forEach(day => {
                        const checkbox = document.querySelector(`.day-checkbox[value="${day}"]`);
                        if (checkbox) checkbox.checked = true;
                    });
                }
                
                document.getElementById('domain-modal').classList.remove('hidden');
            }

            getDomainColor(domain) {
                // Generate a consistent color based on the domain name
                const domainColors = {
                    'AI/ML': 'bg-purple-500/20 text-purple-300 border border-purple-500/30',
                    'Web Development': 'bg-blue-500/20 text-blue-300 border border-blue-500/30',
                    'Data Science': 'bg-green-500/20 text-green-300 border border-green-500/30',
                    'Cloud Computing': 'bg-yellow-500/20 text-yellow-300 border border-yellow-500/30',
                    'Cybersecurity': 'bg-red-500/20 text-red-300 border border-red-500/30',
                    'Programming': 'bg-indigo-500/20 text-indigo-300 border border-indigo-500/30',
                };
                
                // If domain is in our predefined list, use that color
                if (domainColors[domain]) {
                    return domainColors[domain];
                }
                
                // Otherwise, generate a color based on the domain name
                const colors = [
                    'bg-purple-500/20 text-purple-300 border border-purple-500/30',
                    'bg-blue-500/20 text-blue-300 border border-blue-500/30',
                    'bg-green-500/20 text-green-300 border border-green-500/30',
                    'bg-yellow-500/20 text-yellow-300 border border-yellow-500/30',
                    'bg-red-500/20 text-red-300 border border-red-500/30',
                    'bg-indigo-500/20 text-indigo-300 border border-indigo-500/30',
                    'bg-pink-500/20 text-pink-300 border border-pink-500/30',
                    'bg-teal-500/20 text-teal-300 border border-teal-500/30',
                ];
                
                let hash = 0;
                for (let i = 0; i < domain.length; i++) {
                    hash = domain.charCodeAt(i) + ((hash << 5) - hash);
                }
                
                return colors[Math.abs(hash) % colors.length];
            }

            setupEventListeners() {
                // Task form submission
                document.getElementById('task-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const day = document.getElementById('task-day').value;
                    const domain = document.getElementById('task-domain').value;
                    const description = document.getElementById('task-description').value.trim();
                    
                    if (domain && description) {
                        this.addTask(day, domain, description);
                        document.getElementById('task-description').value = '';
                        
                        // Show success feedback
                        const button = e.target.querySelector('button');
                        const originalText = button.textContent;
                        button.textContent = 'Task Added!';
                        button.classList.remove('from-green-600', 'to-emerald-700');
                        button.classList.add('from-green-700', 'to-green-800');
                        
                        setTimeout(() => {
                            button.textContent = originalText;
                            button.classList.remove('from-green-700', 'to-green-800');
                            button.classList.add('from-green-600', 'to-emerald-700');
                        }, 1500);
                    }
                });

                // Week navigation
                document.getElementById('prev-week').addEventListener('click', () => {
                    if (this.currentWeek > 1) {
                        this.currentWeek--;
                        this.renderWeek();
                        this.updateAnalytics();
                    }
                });

                document.getElementById('next-week').addEventListener('click', () => {
                    this.currentWeek++;
                    this.renderWeek();
                    this.updateAnalytics();
                });

                // Domain management
                document.getElementById('show-domain-modal').addEventListener('click', () => {
                    document.getElementById('add-domain-modal').classList.remove('hidden');
                });

                document.getElementById('save-new-domain').addEventListener('click', () => {
                    const domainName = document.getElementById('new-domain-name').value.trim();
                    if (domainName) {
                        this.addDomain(domainName);
                        document.getElementById('new-domain-name').value = '';
                        document.getElementById('add-domain-modal').classList.add('hidden');
                    }
                });

                // Domain assignment modal
                document.getElementById('save-domain-days').addEventListener('click', () => {
                    const selectedDays = Array.from(document.querySelectorAll('.day-checkbox:checked'))
                        .map(checkbox => checkbox.value);
                    this.updateDomainDays(this.currentEditingDomain, selectedDays);
                    document.getElementById('domain-modal').classList.add('hidden');
                });

                // Modal close buttons
                document.getElementById('close-modal').addEventListener('click', () => {
                    document.getElementById('domain-modal').classList.add('hidden');
                });

                document.getElementById('cancel-modal').addEventListener('click', () => {
                    document.getElementById('domain-modal').classList.add('hidden');
                });

                document.getElementById('close-add-modal').addEventListener('click', () => {
                    document.getElementById('add-domain-modal').classList.add('hidden');
                });

                document.getElementById('cancel-add-modal').addEventListener('click', () => {
                    document.getElementById('add-domain-modal').classList.add('hidden');
                });

                // Event delegation for task checkboxes, delete buttons, and domain tags
                document.addEventListener('click', (e) => {
                    if (e.target.type === 'checkbox' && e.target.hasAttribute('data-day')) {
                        const day = e.target.getAttribute('data-day');
                        const taskId = parseFloat(e.target.getAttribute('data-id'));
                        this.toggleTask(day, taskId);
                    }
                    
                    if (e.target.closest('.delete-task')) {
                        const button = e.target.closest('.delete-task');
                        const day = button.getAttribute('data-day');
                        const taskId = parseFloat(button.getAttribute('data-id'));
                        this.deleteTask(day, taskId);
                    }
                    
                    if (e.target.closest('.delete-domain')) {
                        e.stopPropagation();
                        const button = e.target.closest('.delete-domain');
                        const domain = button.getAttribute('data-domain');
                        this.removeDomain(domain);
                    }
                    
                    // Click on domain tag (but not the delete button)
                    if (e.target.closest('[data-domain]') && !e.target.closest('.delete-domain')) {
                        const tag = e.target.closest('[data-domain]');
                        const domain = tag.getAttribute('data-domain');
                        this.openDomainModal(domain);
                    }
                });
            }

            updateAnalytics() {
                const weekData = this.getCurrentWeekData();
                
                // Calculate completion stats
                let totalTasks = 0;
                let completedTasks = 0;
                const domainCount = {};
                const dailyCompletion = {
                    monday: 0, tuesday: 0, wednesday: 0, thursday: 0, 
                    friday: 0, saturday: 0, sunday: 0
                };

                Object.keys(weekData).forEach(day => {
                    const dayTasks = weekData[day];
                    totalTasks += dayTasks.length;
                    const dayCompleted = dayTasks.filter(t => t.completed).length;
                    completedTasks += dayCompleted;
                    
                    // Calculate daily completion percentage
                    dailyCompletion[day] = dayTasks.length > 0 ? 
                        Math.round((dayCompleted / dayTasks.length) * 100) : 0;
                    
                    // Count tasks by domain
                    dayTasks.forEach(task => {
                        if (!domainCount[task.domain]) {
                            domainCount[task.domain] = { total: 0, completed: 0 };
                        }
                        domainCount[task.domain].total++;
                        if (task.completed) {
                            domainCount[task.domain].completed++;
                        }
                    });
                });

                // Update completion stats
                const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
                document.getElementById('completion-rate').textContent = `${completionRate}%`;
                document.getElementById('completion-bar').style.width = `${completionRate}%`;
                document.getElementById('completed-tasks').textContent = completedTasks;
                document.getElementById('total-tasks').textContent = totalTasks;

                // Update charts
                this.updateDomainChart(domainCount);
                this.updateMonthlyChart();
            }

            updateDomainChart(domainData) {
                const ctx = document.getElementById('domain-chart').getContext('2d');
                
                // Destroy existing chart if it exists
                if (this.domainChart) {
                    this.domainChart.destroy();
                }
                
                const domains = Object.keys(domainData);
                const completedData = domains.map(domain => domainData[domain].completed);
                const totalData = domains.map(domain => domainData[domain].total);
                
                this.domainChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: domains,
                        datasets: [{
                            data: totalData,
                            backgroundColor: [
                                'rgba(147, 51, 234, 0.7)', // Purple
                                'rgba(59, 130, 246, 0.7)', // Blue
                                'rgba(16, 185, 129, 0.7)', // Green
                                'rgba(234, 179, 8, 0.7)',  // Yellow
                                'rgba(239, 68, 68, 0.7)',  // Red
                                'rgba(99, 102, 241, 0.7)', // Indigo
                                'rgba(236, 72, 153, 0.7)', // Pink
                                'rgba(20, 184, 166, 0.7)', // Teal
                            ],
                            borderColor: [
                                'rgba(147, 51, 234, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(16, 185, 129, 1)',
                                'rgba(234, 179, 8, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(99, 102, 241, 1)',
                                'rgba(236, 72, 153, 1)',
                                'rgba(20, 184, 166, 1)',
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: 'white',
                                    font: {
                                        size: 10
                                    }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.raw;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = Math.round((value / total) * 100);
                                        return `${label}: ${value} (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            updateMonthlyChart() {
                const ctx = document.getElementById('monthly-chart').getContext('2d');
                
                // Destroy existing chart if it exists
                if (this.monthlyChart) {
                    this.monthlyChart.destroy();
                }
                
                // Get last 6 months of data
                const months = Object.keys(this.monthsData).sort().slice(-6);
                const domains = [...new Set(
                    months.flatMap(month => Object.keys(this.monthsData[month] || {}))
                )];
                
                const datasets = domains.map((domain, index) => {
                    const colors = [
                        'rgba(147, 51, 234, 1)', // Purple
                        'rgba(59, 130, 246, 1)', // Blue
                        'rgba(16, 185, 129, 1)', // Green
                        'rgba(234, 179, 8, 1)',  // Yellow
                        'rgba(239, 68, 68, 1)',  // Red
                        'rgba(99, 102, 241, 1)', // Indigo
                        'rgba(236, 72, 153, 1)', // Pink
                        'rgba(20, 184, 166, 1)', // Teal
                    ];
                    
                    return {
                        label: domain,
                        data: months.map(month => this.monthsData[month][domain] || 0),
                        borderColor: colors[index % colors.length],
                        backgroundColor: colors[index % colors.length].replace('1)', '0.1)'),
                        tension: 0.3,
                        fill: false
                    };
                });
                
                this.monthlyChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: months.map(month => {
                            const [year, monthNum] = month.split('-');
                            const date = new Date(year, monthNum - 1);
                            return date.toLocaleString('default', { month: 'short', year: '2-digit' });
                        }),
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                title: {
                                    display: true,
                                    text: 'Tasks',
                                    color: 'rgba(255, 255, 255, 0.7)'
                                }
                            },
                            x: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: 'white',
                                    font: {
                                        size: 10
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            new LearningTracker();
        });
    </script>
</body>
</html>
